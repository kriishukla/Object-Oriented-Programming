var miro=(()=>{var he=Object.defineProperty;var at=t=>he(t,"__esModule",{value:!0}),n=(t,e)=>he(t,"name",{value:e,configurable:!0});var it=(t,e)=>{at(t);for(var r in e)he(t,r,{get:e[r],enumerable:!0})};var wt={};it(wt,{board:()=>st,clientVersion:()=>rt});var Ce="sdkv2-plugin-message";function mt(t){return t.data?.commandId===Ce}n(mt,"isPluginMessageEvent");function pt(t){return t!==null&&"window"in t}n(pt,"isWindow");var Y=class{constructor(e){this.destroyed=!1;this.destroy=n(()=>{this.clients.forEach(e=>{e.waiting.clear()}),this.clients.clear(),this.hostWindow.removeEventListener("message",this.handlePostMessage),this.destroyed=!0},"destroy");this.createBus=n((e,r)=>{if(this.destroyed)throw new Error("SdkCommunicationBus: createBus is called on a destroyed instance");this.clients.set(e.container,{handler:r,target:e,waiting:new Map});let s=this.dispatch,{destroyBus:o}=this;return{target:e,dispatch(i,u){return s(e.container,i,u)},destroy(){return o(e.container)}}},"createBus");this.destroyBus=n(e=>{let r=this.clients.get(e);r&&(r.waiting.clear(),this.clients.delete(e))},"destroyBus");this.hostWindow=e,this.clients=new Map,this.handlePostMessage=this.handlePostMessage.bind(this),this.dispatch=this.dispatch.bind(this),this.destroyBus=this.destroyBus.bind(this),this.hostWindow.addEventListener("message",this.handlePostMessage)}getId(){return Math.random().toString(36).slice(-10)}handlePostMessage(e){if(!mt(e)||!pt(e.source))return;let r=this.clients.get(e.source);if(!r||r.target.origin!=="*"&&e.origin!==r.target.origin)return;let{data:s}=e,o=r.waiting.get(s.msgId);if(o)r.waiting.delete(s.msgId),o.resolve(s.payload);else{let i=n(u=>{u&&this.dispatch(r.target.container,u,s.msgId)},"after");r.handler(s.payload).then(i).catch(i)}}dispatch(e,r,s){return new Promise((o,i)=>{let u=!s,_=this.clients.get(e);if(!_)return;let X;u?(X=this.getId(),_.waiting.set(X,{resolve:o,reject:i})):X=s;let ot={commandId:Ce,payload:r,msgId:X};_.target.container.postMessage(ot,_.target.origin),!u&&s&&(_.waiting.delete(s),o(null))})}};n(Y,"SdkCommunicationBus");function Oe(t){return Object.keys(t)}n(Oe,"keys");function Re(){return Math.random().toString(36).slice(-10)}n(Re,"getId");function Ee(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}n(Ee,"isObject");function p(t,...e){if(!e.length)return t;let r=e.shift();return Ee(t)&&Ee(r)&&Object.keys(r).forEach(s=>{Ee(r[s])?(t[s]||Object.assign(t,{[s]:{}}),p(t[s],r[s])):Object.assign(t,{[s]:r[s]})}),p(t,...e)}n(p,"mergeDeep");function S(t){let e={};return Object.keys(t).forEach(r=>{let s=t[r];typeof s!="function"&&(e[r]=s)}),e}n(S,"asProps");function Le(t,e){let r={...t};return delete r[e],r}n(Le,"omit");var z;(function(r){r.Success="S",r.Fail="F"})(z||(z={}));var $=class{constructor({clientWindow:e=window}){let r=new Y(e);this.waitingResponse=new Map,this.handlers=new Map,this.responseHandler=this.responseHandler.bind(this),this.handle=this.handle.bind(this),this.busDispatcher=r.createBus({container:e.parent,origin:"*"},this.handle)}push(e,r){let s=Re(),i=[{name:e,payload:r,id:s}];return new Promise((u,_)=>{this.waitingResponse.set(s,{resolve:u,reject:_}),this.busDispatcher.dispatch(i).then(this.responseHandler)})}responseHandler(e){let r=e;for(let s=0;s<r.length;s++){let o=r[s];if(!o)continue;let i=this.waitingResponse.get(o.id);i&&(o.status===z.Success?i.resolve(o.payload):o.status===z.Fail&&i.reject(new Error(String(o.payload))),this.waitingResponse.delete(o.id))}return Promise.resolve([])}handle(e){let r=e,s=[];for(let o=0;o<r.length;o++){let i=r[o];if(i.status){this.responseHandler([i]);continue}let u=this.handlers.get(i.id);u&&u.forEach(_=>{s.push(_(i))})}return Promise.all(s)}subscribe(e,r){let s=this.handlers.get(e)||[];this.handlers.set(e,[...s,r])}unsubscribe(e,r){r||this.handlers.delete(e);let s=(this.handlers.get(e)||[]).filter(o=>o!==r);this.handlers.set(e,s)}};n($,"IframeCommander");var dt=n(()=>{throw new Error("board not initialized")},"boardNotInitialised"),Me,y=n(()=>Me??dt(),"board"),ct=n(()=>{throw new Error("commander not initialized")},"commanderNotInitialised"),Ne,g=n(()=>Ne??ct(),"commander"),Se=n(t=>{Me=t.board,Ne=t.commander},"register");async function a(t,e){return e===void 0?g().push(t):g().push(t,e)}n(a,"runCommand");async function T(t,e){return a(`EXPERIMENTAL_${t}`,e)}n(T,"runExperimentalCommand");var c=class{async sync(){return y().sync(this)}async getMetadata(e){return y().getMetadata(this,e)}async setMetadata(e,r){return y().setMetadata(this,e,r)}};n(c,"BaseItem");var b=class extends c{constructor(e){super();this.type="text";this.content="";this.style={fillColor:"transparent",fillOpacity:1,fontFamily:"arial",fontSize:14,textAlign:"left",color:"#1a1a1a"};p(this,e)}};n(b,"Text");var Ge;(function(m){m.Rectangle="rectangle",m.Circle="circle",m.Triangle="triangle",m.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",m.RoundRectangle="round_rectangle",m.Rhombus="rhombus",m.Parallelogram="parallelogram",m.Star="star",m.RightArrow="right_arrow",m.LeftArrow="left_arrow",m.Pentagon="pentagon",m.Hexagon="hexagon",m.Octagon="octagon",m.Trapezoid="trapezoid",m.FlowChartPredefinedProcess="flow_chart_predefined_process",m.LeftRightArrow="left_right_arrow",m.Cloud="cloud",m.LeftBrace="left_brace",m.RightBrace="right_brace",m.Cross="cross",m.Can="can"})(Ge||(Ge={}));var j;(function(d){d.Gray="gray",d.LightYellow="light_yellow",d.Yellow="yellow",d.Orange="orange",d.LightGreen="light_green",d.Green="green",d.DarkGreen="dark_green",d.Cyan="cyan",d.LightPink="light_pink",d.Pink="pink",d.Violet="violet",d.Red="red",d.LightBlue="light_blue",d.Blue="blue",d.DarkBlue="dark_blue",d.Black="black"})(j||(j={}));var Z;(function(l){l.Red="red",l.Magenta="magenta",l.Violet="violet",l.LightGreen="light_green",l.Green="green",l.DarkGreen="dark_green",l.Cyan="cyan",l.Blue="blue",l.DarkBlue="dark_blue",l.Yellow="yellow",l.Gray="gray",l.Black="black"})(Z||(Z={}));var P=class extends c{constructor(e){super();this.type="sticky_note";this.shape="square";this.content="";this.style={fillColor:j.LightYellow,textAlign:"center",textAlignVertical:"middle"};this.tagIds=[];p(this,e)}};n(P,"StickyNote");var I=class extends c{constructor(e){super();this.type="shape";this.content="";this.shape="rectangle";this.style={fillColor:"transparent",fontFamily:"arial",fontSize:14,textAlign:"center",textAlignVertical:"middle",borderStyle:"normal",borderOpacity:1,borderColor:"#1a1a1a",borderWidth:2,fillOpacity:1,color:"#1a1a1a"};p(this,e)}};n(I,"Shape");var G=class extends c{constructor(e){super();this.type="shape";this.content="";this.shape="rectangle";this.style={fillColor:"transparent",fontFamily:"arial",fontSize:14,textAlign:"center",textAlignVertical:"middle",borderStyle:"normal",borderOpacity:1,borderColor:"#1a1a1a",borderWidth:2,fillOpacity:1,color:"#1a1a1a"};p(this,e)}async sync(){return y().experimental.sync(this)}};n(G,"ShapeExperimental");var D=class extends c{constructor(e){super();this.type="image";this.title="";p(this,e)}};n(D,"Image");var x=class extends c{constructor(e){super();this.type="card";this.title="";this.description="";this.style={};this.dueDate=void 0;this.assignee=void 0;this.taskStatus="none";this.tagIds=[];this.fields=[];p(this,e)}};n(x,"Card");var A=class extends c{constructor(e){super();this.type="app_card";this.owned=!1;this.title="";this.description="";this.style={};this.tagIds=[];this.status="disconnected";this.fields=[];p(this,e)}};n(A,"AppCard");var C=class extends c{constructor(e){super();this.type="frame";this.title="";this.childrenIds=[];this.style={fillColor:"transparent"};p(this,e)}async add(e){this.childrenIds.push(e.id),await this.sync();let[r]=await y().experimental.get({id:e.id});return p(e,r),e}async remove(e){let r=e.id;if(!r)throw new Error("trying to remove a non-existent item from a frame");let s=this.childrenIds.findIndex(i=>i===r);if(s===-1)throw new Error(`Can't remove item ${r} from frame ${this.id}. The item is not a current child`);this.childrenIds.splice(s,1),await this.sync();let[o]=await y().experimental.get({id:e.id});p(e,o)}async getChildren(){let e=this.childrenIds;return e.length===0?[]:y().get({id:e})}};n(C,"Frame");var k=class extends c{constructor(e){super();this.type="unsupported";p(this,e)}};n(k,"Unsupported");var O=class extends c{constructor(e){super();this.type="preview";p(this,e)}};n(O,"Preview");var R=class extends c{constructor(e){super();this.type="embed";this.previewUrl="";this.mode="inline";p(this,e)}};n(R,"Embed");var L=class{constructor(e){this.type="connector";this.shape="curved";this.start=void 0;this.end=void 0;this.style={};this.captions=[];p(this,e)}async sync(){return y().sync(this)}async getMetadata(e){return y().getMetadata(this,e)}async setMetadata(e,r){return y().setMetadata(this,e,r)}};n(L,"Connector");var M=class extends c{constructor(e){super();this.type="mindmap_node";this.nodeView={type:"text",content:""};this.layout="horizontal";this.direction=void 0;this.childrenIds=[];this.isRoot=!0;p(this,e)}async sync(){return y().experimental.sync(this)}async add(e){this.childrenIds.push(e.id),await this.sync();let[r]=await y().experimental.get({id:e.id});return p(e,r),e}async getChildren(){let e=this.childrenIds;return e.length===0?[]:y().experimental.get({id:e})}};n(M,"MindmapNode");var K=class extends c{constructor(e){super();this.type="mindmap_node";this.nodeView={type:"text",content:""};this.children=[];this.childrenIds=[];this.isRoot=!0;this.layout="horizontal";this.direction=void 0;p(this,e)}};n(K,"MindmapTreeNode");var N=class{constructor(e){this.type="tag";this.title="";this.color=Z.Red;p(this,e)}async sync(){return y().sync(this)}};n(N,"TagEntity");function E(t){switch(t.type){case"text":return new b(t);case"sticky_note":return new P(t);case"shape":return new I(t);case"image":return new D(t);case"frame":return new C(t);case"preview":return new O(t);case"card":return new x(t);case"app_card":return new A(t);case"embed":return new R(t);case"connector":return new L(t);case"tag":return new N(t);case"document":case"mockup":case"curve":case"webscreen":case"usm":case"mindmap":case"kanban":case"table":case"svg":case"emoji":case"mindmap_node":default:return new k(t)}}n(E,"convertToSdkFormat");function F(t){switch(t.type){case"shape":return new G(t);case"mindmap_node":return new M(t);default:return E(t)}}n(F,"convertToSdkFormatExperimental");var lt=["drag","drop","dragend","dragstart"],ut={"pointer-events":"none","user-select":"none","-webkit-user-select":"none","-webkit-touch-callout":"none"},Q=class{constructor(){this.listeners=[];this.originalBodyStyle={};this.dragStartPosition={x:-1/0,y:-1/0}}setDragStartPosition(e,r){this.dragStartPosition={x:e,y:r}}shouldDispatchDrag(e,r){return Math.abs(e-this.dragStartPosition.x)>Q.DRAG_THRESHOLD||Math.abs(r-this.dragStartPosition.y)>Q.DRAG_THRESHOLD}resetDragging(){throw new Error("Not implemented")}addListener(e,r,s){this.listeners.push({type:e,selector:r,handler:s})}removeListener(e,r,s){this.listeners=this.listeners.filter(o=>o.type!==e||r!=null&&o.selector!==r||s!=null&&o.handler!==s)}isDraggableElement(e){return!(e instanceof HTMLElement)&&!(e instanceof SVGElement)?!1:this.listeners.some(({selector:r})=>!!e.closest(r))}disableClickEvents(){Object.entries(ut).forEach(([e,r])=>{this.originalBodyStyle[e]=document.body.style.getPropertyValue(e),document.body.style.setProperty(e,r)})}restoreClickEvents(){Object.entries(this.originalBodyStyle).forEach(([e,r])=>{document.body.style.setProperty(e,r)}),this.originalBodyStyle={}}dragEnd(e){this.dispatch("dragend",{target:e,clientX:NaN,clientY:NaN,screenX:NaN,screenY:NaN})}dispatch(e,r){this.listeners.forEach(({selector:s,handler:o,type:i})=>{if(e!==i)return;let u=r.target.closest(s);if(!u)return;let _=new CustomEvent(e,{detail:{...r,target:u,type:e}});o(_)})}},B=Q;n(B,"BaseDragSensor"),B.DRAG_THRESHOLD=8;var fe=class extends B{constructor(){super();this.isDragging=!1;this.onMouseDown=n(e=>{let r=e.target;!this.isDraggableElement(r)||(this.target=r,this.setDragStartPosition(e.clientX,e.clientY),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove,{passive:!0}))},"onMouseDown");this.onMouseMove=n(e=>{if(!this.target)return;let{clientX:r,clientY:s,screenX:o,screenY:i}=e;if(!this.isDragging&&!this.shouldDispatchDrag(r,s))return;let u=this.isDragging?"drag":"dragstart";this.isDragging||this.disableClickEvents(),this.isDragging=!0,this.dispatch(u,{target:this.target,clientX:r,clientY:s,screenX:o,screenY:i})},"onMouseMove");this.onMouseUp=n(e=>{if(e.preventDefault(),this.isDragging&&this.target){let{clientX:r,clientY:s,screenX:o,screenY:i}=e;this.dispatch("drop",{target:this.target,clientX:r,clientY:s,screenX:o,screenY:i})}window.requestAnimationFrame(()=>this.resetDragging())},"onMouseUp");this.resetDragging=n(()=>{document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove),this.isDragging&&this.target&&this.dragEnd(this.target),this.target&&this.restoreClickEvents(),this.isDragging=!1,this.target=void 0},"resetDragging");document.addEventListener("mousedown",this.onMouseDown),window.addEventListener("blur",this.resetDragging)}};n(fe,"MouseDragSensor");var yt=100,U=!1;window.addEventListener("touchmove",t=>{!U||t.preventDefault()},{passive:!1});var _e=class extends B{constructor(){super();this.onTouchStart=n(e=>{let{target:r}=e;if(!this.isDraggableElement(r))return;let{clientX:s,clientY:o,screenX:i,screenY:u}=e.touches[0];this.setDragStartPosition(s,o),this.target=r,this.tapTimeout=window.setTimeout(()=>{this.startDragging({target:r,clientX:s,clientY:o,screenX:i,screenY:u})},yt),window.addEventListener("touchend",this.onTouchEnd),window.addEventListener("touchcancel",this.resetDragging),window.addEventListener("touchmove",this.resetDragging)},"onTouchStart");this.onTouchMove=n(e=>{if(!this.target)return;let{clientX:r,clientY:s,screenX:o,screenY:i}=e.touches[0];this.dispatch("drag",{target:this.target,clientX:r,clientY:s,screenX:o,screenY:i})},"onTouchMove");this.onTouchEnd=n(e=>{if(U&&this.target){let{clientX:s,clientY:o,screenX:i,screenY:u}=e.changedTouches[0];this.dispatch("dragend",{target:this.target,clientX:s,clientY:o,screenX:i,screenY:u})}window.requestAnimationFrame(()=>this.resetDragging())},"onTouchEnd");this.startDragging=n(e=>{!this.shouldDispatchDrag(e.clientX,e.clientY)||(window.removeEventListener("touchmove",this.resetDragging),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),U=!0,this.disableClickEvents(),this.dispatch("dragstart",e))},"startDragging");this.resetDragging=n(()=>{window.removeEventListener("touchend",this.onTouchEnd),window.removeEventListener("touchcancel",this.resetDragging),window.removeEventListener("touchmove",this.resetDragging),window.removeEventListener("touchmove",this.onTouchMove),U&&this.target&&(this.restoreClickEvents(),this.dragEnd(this.target)),this.target=void 0,U=!1,this.tapTimeout!==void 0&&(clearTimeout(this.tapTimeout),this.tapTimeout=void 0)},"resetDragging");window.addEventListener("touchstart",this.onTouchStart),window.addEventListener("blur",this.resetDragging)}};n(_e,"TouchDragSensor");var J=class{constructor(e){this.touchSensor=new _e,this.mouseSensor=new fe,Object.assign(this,e)}addListener(e,r){this.mouseSensor.addListener(e,this.selector,r),this.touchSensor.addListener(e,this.selector,r)}removeListener(e,r){this.mouseSensor.removeListener(e,void 0,r),this.touchSensor.removeListener(e,void 0,r)}reset(){lt.forEach(e=>{this.mouseSensor.removeListener(e),this.touchSensor.removeListener(e)})}resetDragging(){this.mouseSensor.resetDragging(),this.touchSensor.resetDragging()}};n(J,"DragSensor");var v,ke=n(()=>{v?.reset(),v=new J({selector:".miro-draggable"})},"initDragSensor");var ee="internal:drop",W=new Map,Fe;async function Be(t){let e=t.payload;if(e==null)return;let{x:r,y:s}=e,o={x:r,y:s,target:Fe};W.forEach(i=>i(o)),v.resetDragging()}n(Be,"handleInternalDrop");async function gt(){g().unsubscribe(ee,Be),await g().push("UI_UNREGISTER_EVENT",{name:ee})}n(gt,"unsubscribeInternalDrop");async function ht(){await g().push("UI_REGISTER_EVENT",{name:ee}),g().subscribe(ee,Be)}n(ht,"subscribeInternalDropHandler");async function Ue(t){let{clientX:e,clientY:r,target:s}=t.detail;Fe=s,await a("UI_DRAG_START",{clientX:e,clientY:r,dragImage:void 0})}n(Ue,"onDragStart");var ve;async function We(t){if(ve)return;ve=requestAnimationFrame(()=>{ve=void 0});let{clientX:e,clientY:r}=t.detail;a("UI_DRAG_MOVE",{clientX:e,clientY:r})}n(We,"onDrag");async function Ve(t){let{clientX:e,clientY:r}=t.detail;await a("UI_DRAG_DROP",{clientX:e,clientY:r})}n(Ve,"onDrop");async function He(t){await a("UI_DRAG_END")}n(He,"onDragEnd");function qe(t){W.size==0&&(ht(),v.addListener("dragstart",Ue),v.addListener("drag",We),v.addListener("dragend",He),v.addListener("drop",Ve)),W.set(t,t)}n(qe,"attachDragAndDropListeners");function Xe(t){W.delete(t),W.size===0&&(v.removeListener("dragstart",Ue),v.removeListener("drag",We),v.removeListener("dragend",He),v.removeListener("drop",Ve),gt())}n(Xe,"detachDragAndDropListeners");async function Et(t){await g().push("UI_REGISTER_EVENT",{name:t})}n(Et,"registerEventListener");async function ft(t){await g().push("UI_UNREGISTER_EVENT",{name:t})}n(ft,"unregisterEventListener");var we="icon:click",Te="app_card:open",be="app_card:connect",Pe="selection:update",Ie="online_users:update",te="items:create",re="items:delete",ne="experimental:items:update",se="experimental:timer:start",oe="experimental:timer:update",ae="experimental:timer:finish",_t="custom:",Ye=n(t=>t.startsWith(_t),"isCustomEvent"),De=class{constructor(){this.listeners={[we]:[],[Te]:[],[be]:[],[Pe]:[],[Ie]:[],[te]:[],[ne]:[],[re]:[],[se]:[],[oe]:[],[ae]:[]}}async addListener(e,r){this.listeners[e]||(this.listeners[e]=[]);let s=this.listeners[e];if(s.push(r),s.length===1)return Et(e)}async removeListener(e,r){if(this.listeners[e]=this.listeners[e].filter(s=>s!==r),this.listeners[e].length===0)return ft(e)}listen(){Oe(this.listeners).forEach(e=>{g().unsubscribe(e),g().subscribe(e,async r=>{this.listeners[e].forEach(s=>s(r))})})}};n(De,"AppManager");var ie={drop:new Map,"app_card:connect":new Map,"app_card:open":new Map,"icon:click":new Map,"selection:update":new Map,"online_users:update":new Map,[te]:new Map,[ne]:new Map,[re]:new Map,[se]:new Map,[oe]:new Map,[ae]:new Map};function f(t,e,r){return ie[t]||(ie[t]=new Map),ie[t].set(e,r),r}n(f,"linkExternalToInternalEventHandler");function V(t,e){let r=ie[t],s=r.get(e);return r.delete(e),s}n(V,"getInternalEventHandlerFromExternal");var h=new De;function ze(t,e){switch(t){case"drop":return qe(f(t,e,e)),Promise.resolve();case we:return h.addListener(t,f(t,e,async()=>e()));case Te:return h.addListener(t,f(t,e,async r=>{let{appCard:s}=r.payload,o={appCard:E(s)};e(o)}));case be:return h.addListener(t,f(t,e,async r=>{let{appCard:s}=r.payload,o={appCard:E(s)};e(o)}));case Pe:return h.addListener(t,f(t,e,async r=>{let{items:s}=r.payload,o={items:s.map(i=>E(i))};e(o)}));case Ie:return h.addListener(t,f(t,e,async r=>{let s=r.payload;e(s)}));case te:return h.addListener(t,f(t,e,async r=>{let{items:s}=r.payload,o={items:s.map(i=>E(i))};e(o)}));case ne:return h.addListener(t,f(t,e,async r=>{let{items:s}=r.payload,o={items:s.map(i=>E(i))};e(o)}));case re:return h.addListener(t,f(t,e,async r=>{let{items:s}=r.payload,o={items:s.map(i=>E(i))};e(o)}));case se:case oe:case ae:return h.addListener(t,f(t,e,async r=>{e(r.payload)}));default:if(Ye(t)){let r=n(async s=>{let{items:o}=s.payload,i={items:o.map(u=>E(u))};e(i)},"internalHandler");return g().subscribe(t,r),f(t,e,r),h.addListener(t,r)}throw new Error(`unknown event: ${t}`)}}n(ze,"on");function $e(t,e){switch(t){case"drop":{let r=V(t,e);return r&&Xe(r),Promise.resolve()}case we:case Te:case be:case Pe:case Ie:case te:case ne:case re:case se:case oe:case ae:return h.removeListener(t,V(t,e));default:if(Ye(t)){let r=V(t,e);return g().unsubscribe(t,r),h.removeListener(t,r)}throw new Error(`unknown event: ${t}`)}}n($e,"off");var me=class{constructor(){this.on=ze;this.off=$e}async openPanel(e){await a("UI_OPEN_PANEL",e)}async closePanel(){await a("UI_CLOSE_PANEL")}async openModal(e){await a("UI_OPEN_MODAL",e)}async closeModal(){await a("UI_CLOSE_MODAL")}};n(me,"BoardUI");var xe={WIDGET_CREATE:"WIDGET_CREATE",WIDGET_UPDATE:"WIDGET_UPDATE",WIDGET_REMOVE:"WIDGET_REMOVE",WIDGET_GET:"WIDGET_GET",WIDGET_GET_METADATA:"WIDGET_GET_METADATA",WIDGET_SET_METADATA:"WIDGET_SET_METADATA",GET_SELECTION:"GET_SELECTION",SELECT_WIDGETS:"SELECT_WIDGETS",DESELECT_WIDGETS:"DESELECT_WIDGETS",GET_BOARD_APP_DATA:"GET_BOARD_APP_DATA",SET_BOARD_APP_DATA:"SET_BOARD_APP_DATA",CLEAR_BOARD_APP_DATA:"CLEAR_BOARD_APP_DATA",UI_DRAG_START:"UI_DRAG_START",UI_DRAG_MOVE:"UI_DRAG_MOVE",UI_DRAG_DROP:"UI_DRAG_DROP",UI_DRAG_END:"UI_DRAG_END",UI_REGISTER_EVENT:"UI_REGISTER_EVENT",UI_UNREGISTER_EVENT:"UI_UNREGISTER_EVENT",GET_ONLINE_USERS:"GET_ONLINE_USERS",GET_ID_TOKEN:"GET_ID_TOKEN",GET_BOARD_INFO:"GET_BOARD_INFO",GET_USER_INFO:"GET_USER_INFO",UI_OPEN_MODAL:"UI_OPEN_MODAL",UI_CLOSE_MODAL:"UI_CLOSE_MODAL",UI_OPEN_PANEL:"UI_OPEN_PANEL",UI_CLOSE_PANEL:"UI_CLOSE_PANEL",VIEWPORT_GET:"VIEWPORT_GET",VIEWPORT_SET:"VIEWPORT_SET",VIEWPORT_ZOOM_TO:"VIEWPORT_ZOOM_TO",VIEWPORT_SET_ZOOM:"VIEWPORT_SET_ZOOM",VIEWPORT_GET_ZOOM:"VIEWPORT_GET_ZOOM",SHOW_NOTIFICATION:"SHOW_NOTIFICATION",BRING_TO_FRONT:"BRING_TO_FRONT",SEND_TO_BACK:"SEND_TO_BACK",TIMER_START:"TIMER_START",TIMER_IS_STARTED:"TIMER_IS_STARTED",TIMER_PROLONG:"TIMER_PROLONG",TIMER_STOP:"TIMER_STOP",TIMER_PAUSE:"TIMER_PAUSE",TIMER_RESUME:"TIMER_RESUME",GET_VOTING_RESULTS:"GET_VOTING_RESULTS",ATTENTION_FOLLOW:"ATTENTION_FOLLOW",ATTENTION_IS_FOLLOWING:"ATTENTION_IS_FOLLOWING",ATTENTION_GET_FOLLOWED_USER:"ATTENTION_GET_FOLLOWED_USER",ATTENTION_UNFOLLOW:"ATTENTION_UNFOLLOW",SEND_REALTIME_BROADCAST_EVENT:"SEND_REALTIME_BROADCAST_EVENT"},H={...Object.entries(xe).reduce((t,[e,r])=>{let s=`EXPERIMENTAL_${r}`;return{...t,[e]:s}},{})},je;(function(t){t.Red="red",t.Magenta="magenta",t.Violet="violet",t.LightGreen="light_green",t.Green="green",t.DarkGreen="dark_green",t.Cyan="cyan",t.Blue="blue",t.DarkBlue="dark_blue",t.Yellow="yellow",t.Gray="gray",t.Black="black"})(je||(je={}));var Ze;(function(t){t.Gray="gray",t.LightYellow="light_yellow",t.Yellow="yellow",t.Orange="orange",t.LightGreen="light_green",t.Green="green",t.DarkGreen="dark_green",t.Cyan="cyan",t.LightPink="light_pink",t.Pink="pink",t.Violet="violet",t.Red="red",t.LightBlue="light_blue",t.Blue="blue",t.DarkBlue="dark_blue",t.Black="black"})(Ze||(Ze={}));var Ke;(function(t){t.Rectangle="rectangle",t.Circle="circle",t.Triangle="triangle",t.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",t.RoundRectangle="round_rectangle",t.Rhombus="rhombus",t.Parallelogram="parallelogram",t.Star="star",t.RightArrow="right_arrow",t.LeftArrow="left_arrow",t.Pentagon="pentagon",t.Hexagon="hexagon",t.Octagon="octagon",t.Trapezoid="trapezoid",t.FlowChartPredefinedProcess="flow_chart_predefined_process",t.LeftRightArrow="left_right_arrow",t.Cloud="cloud",t.LeftBrace="left_brace",t.RightBrace="right_brace",t.Cross="cross",t.Can="can"})(Ke||(Ke={}));var Je;(function(t){t.Rectangle="rectangle",t.Circle="circle",t.Triangle="triangle",t.WedgeRoundRectangleCallout="wedge_round_rectangle_callout",t.RoundRectangle="round_rectangle",t.Rhombus="rhombus",t.Parallelogram="parallelogram",t.Star="star",t.RightArrow="right_arrow",t.LeftArrow="left_arrow",t.Pentagon="pentagon",t.Hexagon="hexagon",t.Octagon="octagon",t.Trapezoid="trapezoid",t.FlowChartPredefinedProcess="flow_chart_predefined_process",t.LeftRightArrow="left_right_arrow",t.Cloud="cloud",t.LeftBrace="left_brace",t.RightBrace="right_brace",t.Cross="cross",t.Can="can",t.FlowChartConnector="flow_chart_connector",t.FlowChartMagneticDisk="flow_chart_magnetic_disk",t.FlowChartInputOutput="flow_chart_input_output",t.FlowChartDecision="flow_chart_decision",t.FlowChartDelay="flow_chart_delay",t.FlowChartDisplay="flow_chart_display",t.FlowChartDocument="flow_chart_document",t.FlowChartMagneticDrum="flow_chart_magnetic_drum",t.FlowChartInternalStorage="flow_chart_internal_storage",t.FlowChartManualInput="flow_chart_manual_input",t.FlowChartManualOperation="flow_chart_manual_operation",t.FlowChartMerge="flow_chart_merge",t.FlowChartMultidocument="flow_chart_multidocument",t.FlowChartNoteCurlyLeft="flow_chart_note_curly_left",t.FlowChartNoteCurlyRight="flow_chart_note_curly_right",t.FlowChartNoteSquare="flow_chart_note_square",t.FlowChartOffpageConnector="flow_chart_offpage_connector",t.FlowChartOr="flow_chart_or",t.FlowChartPredefinedProcess2="flow_chart_predefined_process_2",t.FlowChartPreparation="flow_chart_preparation",t.FlowChartProcess="flow_chart_process",t.FlowChartOnlineStorage="flow_chart_online_storage",t.FlowChartSummingJunction="flow_chart_summing_junction",t.FlowChartTerminator="flow_chart_terminator"})(Je||(Je={}));var q;(function(t){t.Error="error",t.Info="info"})(q||(q={}));var Ae=xe.SHOW_NOTIFICATION,pe=class{async showInfo(e){let r={message:e,type:q.Info};await a(Ae,r)}async showError(e){let r={message:e,type:q.Error};await a(Ae,r)}async show(e){await a(Ae,e)}};n(pe,"Notifications");var de=class{constructor(){}async get(){return await a("VIEWPORT_GET")}async set(e){return await a("VIEWPORT_SET",e)}async zoomTo(e){return Array.isArray(e)?a("VIEWPORT_ZOOM_TO",{items:e.map(r=>r.id)}):this.zoomTo([e])}async getZoom(){return await a("VIEWPORT_GET_ZOOM")}async setZoom(e){return await a("VIEWPORT_SET_ZOOM",{zoomLevel:e})}};n(de,"Viewport");var ce=class{async start(e){await T("TIMER_START",{duration:e})}async stop(){return T("TIMER_STOP")}async pause(){return T("TIMER_PAUSE")}async resume(){return T("TIMER_RESUME")}async prolong(e){return T("TIMER_PROLONG",{duration:e})}async isStarted(){return T("TIMER_IS_STARTED")}};n(ce,"Timer");var le=class{async follow(e,r){let s={followee:e,...r};await a(H.ATTENTION_FOLLOW,s)}async isFollowing(){return await a(H.ATTENTION_IS_FOLLOWING)}async getFollowedUser(){return await a(H.ATTENTION_GET_FOLLOWED_USER)}async unfollow(){await a(H.ATTENTION_UNFOLLOW)}};n(le,"Attention");var Qe=n(t=>`experimental:realtime_event:${t}`,"prefixed"),ue=class{async broadcast(e,r){await a("EXPERIMENTAL_SEND_REALTIME_BROADCAST_EVENT",{event:e,payload:r})}on(e,r){let s=n(async i=>{r(i.payload)},"internalHandler"),o=Qe(e);return g().subscribe(o,s),f(o,r,s),h.addListener(o,s)}off(e,r){let s=Qe(e),o=V(s,r);return g().unsubscribe(s,o),h.removeListener(s,o)}};n(ue,"RealtimeEvents");async function et(t,e){return p(e,t),e}n(et,"mergeResponse");async function vt(t){let e=S(t);return a("EXPERIMENTAL_WIDGET_CREATE",e).then(r=>et(r,t))}n(vt,"add");var ye=class{constructor(){this.timer=new ce;this.attention=new le;this.events=new ue}async createMindmapNode(e){let r=await vt(new K(e));return new M(Le(r,"children"))}async get(e){let r=await a("EXPERIMENTAL_WIDGET_GET",e);if(!Array.isArray(r))throw new Error("Error retrieving items");return r.map(F)}async select(e){return(await a("EXPERIMENTAL_SELECT_WIDGETS",e)).map(F)}async deselect(e){return(await a("EXPERIMENTAL_DESELECT_WIDGETS",e)).map(F)}async getSelection(){return(await a("EXPERIMENTAL_GET_SELECTION")).map(F)}async getVotingResults(){return await a("EXPERIMENTAL_GET_VOTING_RESULTS")}async sync(e){let r=S(e);return a("EXPERIMENTAL_WIDGET_UPDATE",r).then(s=>{et(s,e)})}async remove(e){let{id:r,type:s}=e;await a("EXPERIMENTAL_WIDGET_REMOVE",{id:r,type:s})}};n(ye,"Experimental");async function tt(t,e){return p(e,t),e}n(tt,"mergeResponse");async function w(t){let e=S(t);return a("WIDGET_CREATE",e).then(r=>tt(r,t))}n(w,"add");var ge=class{constructor(){this.ui=new me;this.notifications=new pe;this.viewport=new de;this.experimental=new ye}async createCard(e){return w(new x(e))}async createAppCard(e){return w(new A(e))}async createFrame(e){return w(new C(e))}async createImage(e){return w(new D(e))}async createPreview(e){return w(new O(e))}async createShape(e){return w(new I(e))}async createStickyNote(e){return w(new P(e))}async createText(e){return w(new b(e))}async createEmbed(e){return w(new R(e))}async createConnector(e){return w(new L(e))}async createTag(e){return w(new N(e))}async sync(e){let r=S(e);return a("WIDGET_UPDATE",r).then(s=>{tt(s,e)})}async remove(e){let{id:r,type:s}=e;await a("WIDGET_REMOVE",{id:r,type:s})}bringToFront(e){return Array.isArray(e)?a("BRING_TO_FRONT",{items:e.map(r=>r.id)}):this.bringToFront([e])}sendToBack(e){return Array.isArray(e)?a("SEND_TO_BACK",{items:e.map(r=>r.id)}):this.sendToBack([e])}async getById(e){let r=await this.get({id:e});if(Array.isArray(r)&&r.length)return E(r[0]);throw new Error(`Can not retrieve item with id ${e}`)}async get(e){let r=await a("WIDGET_GET",e);if(!Array.isArray(r))throw new Error("Error retrieving items");return r.map(E)}async getInfo(){return a("GET_BOARD_INFO")}async getUserInfo(){return a("GET_USER_INFO")}async getSelection(){return(await a("GET_SELECTION")).map(E)}async getOnlineUsers(){return await a("GET_ONLINE_USERS")}async select(e){return(await a("SELECT_WIDGETS",e)).map(E)}async deselect(e){return(await a("DESELECT_WIDGETS",e)).map(E)}async getAppData(e){return await a("GET_BOARD_APP_DATA",{key:e})}async setAppData(e,r){return await a("SET_BOARD_APP_DATA",{key:e,value:r})}async setMetadata(e,r,s){let o=e.id;return await a("WIDGET_SET_METADATA",{itemId:o,key:r,value:s})}async getMetadata(e,r){let s=e.id;return await a("WIDGET_GET_METADATA",{itemId:s,key:r})}async getIdToken(){return await a("GET_ID_TOKEN")}};n(ge,"Board");var rt="1.48734.0",nt=new $({clientWindow:window}),st=new ge;Se({commander:nt,board:st});nt.push("handshake",{clientVersion:rt});ke();h.listen();new URLSearchParams(location.search).has("autotest")&&console.log("SDKv2 loaded for client version: 1.48734.0 and git commit: 1d00e592164247c9443c36cb75ca8637d5a2f857");return wt;})();
